# GitHub Actions è‡ªåŠ¨æ„å»º Docker é•œåƒ

## ğŸ“¦ åŠŸèƒ½è¯´æ˜

æœ¬é¡¹ç›®å·²é…ç½® GitHub Actionsï¼Œå¯ä»¥è‡ªåŠ¨æ„å»ºå¹¶å‘å¸ƒ Docker é•œåƒåˆ° Docker Hubã€‚

## ğŸ”§ é…ç½®æ­¥éª¤

### 1. å‡†å¤‡ Docker Hub è´¦å·

å¦‚æœè¿˜æ²¡æœ‰ Docker Hub è´¦å·ï¼š
1. è®¿é—® https://hub.docker.com/
2. æ³¨å†Œè´¦å·
3. ï¼ˆå¯é€‰ï¼‰åˆ›å»ºè®¿é—®ä»¤ç‰Œï¼šSettings â†’ Security â†’ New Access Token

### 2. åœ¨ GitHub ä»“åº“ä¸­é…ç½® Secrets

1. æ‰“å¼€ä½ çš„ GitHub ä»“åº“
2. è¿›å…¥ **Settings** â†’ **Secrets and variables** â†’ **Actions**
3. ç‚¹å‡» **New repository secret**ï¼Œæ·»åŠ ä»¥ä¸‹ä¸¤ä¸ª secretsï¼š

   - **åç§°**: `DOCKER_USERNAME`
     **å€¼**: ä½ çš„ Docker Hub ç”¨æˆ·å

   - **åç§°**: `DOCKER_PASSWORD`
     **å€¼**: ä½ çš„ Docker Hub å¯†ç æˆ–è®¿é—®ä»¤ç‰Œï¼ˆæ¨èä½¿ç”¨ä»¤ç‰Œï¼‰

### 3. æ¨é€ä»£ç è§¦å‘æ„å»º

é…ç½®å®Œæˆåï¼Œæœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼è§¦å‘è‡ªåŠ¨æ„å»ºï¼š

#### æ–¹å¼ 1: æ¨é€åˆ° main åˆ†æ”¯
```bash
git push origin main
```
- ä¼šè‡ªåŠ¨æ„å»ºå¹¶æ¨é€ `latest` æ ‡ç­¾

#### æ–¹å¼ 2: åˆ›å»ºç‰ˆæœ¬æ ‡ç­¾
```bash
# åˆ›å»ºå¹¶æ¨é€æ ‡ç­¾
git tag v1.0.0
git push origin v1.0.0
```
- ä¼šè‡ªåŠ¨æ„å»ºå¹¶æ¨é€ `v1.0.0` å’Œ `1.0` æ ‡ç­¾

#### æ–¹å¼ 3: æ‰‹åŠ¨è§¦å‘
1. è¿›å…¥ GitHub ä»“åº“çš„ **Actions** é¡µé¢
2. é€‰æ‹© "Build and Push Docker Image" å·¥ä½œæµ
3. ç‚¹å‡» **Run workflow** æŒ‰é’®

## ğŸ“Š æŸ¥çœ‹æ„å»ºçŠ¶æ€

1. è¿›å…¥ GitHub ä»“åº“çš„ **Actions** é¡µé¢
2. æŸ¥çœ‹å·¥ä½œæµè¿è¡ŒçŠ¶æ€
3. ç‚¹å‡»å…·ä½“çš„è¿è¡Œè®°å½•å¯ä»¥æŸ¥çœ‹è¯¦ç»†æ—¥å¿—

## ğŸ³ ä½¿ç”¨æ„å»ºçš„é•œåƒ

æ„å»ºå®Œæˆåï¼Œå¯ä»¥ä» Docker Hub æ‹‰å–é•œåƒï¼š

```bash
# æ‹‰å–æœ€æ–°ç‰ˆæœ¬
docker pull <ä½ çš„ç”¨æˆ·å>/jellyseerr-moviepilot-syncer:latest

# æ‹‰å–ç‰¹å®šç‰ˆæœ¬
docker pull <ä½ çš„ç”¨æˆ·å>/jellyseerr-moviepilot-syncer:v1.0.0
```

## ğŸ”„ æ›´æ–°é•œåƒ

æ¯æ¬¡æ¨é€ä»£ç æˆ–åˆ›å»ºæ–°æ ‡ç­¾æ—¶ï¼ŒGitHub Actions ä¼šè‡ªåŠ¨ï¼š
1. æ£€å‡ºä»£ç 
2. è®¾ç½® Docker Buildx
3. ç™»å½• Docker Hub
4. æ„å»º Docker é•œåƒ
5. æ¨é€åˆ° Docker Hub

æ•´ä¸ªè¿‡ç¨‹é€šå¸¸éœ€è¦ 3-5 åˆ†é’Ÿã€‚

## ğŸ“ é•œåƒæ ‡ç­¾è§„åˆ™

å·¥ä½œæµä¼šæ ¹æ®ä¸åŒçš„è§¦å‘æ¡ä»¶åˆ›å»ºä¸åŒçš„æ ‡ç­¾ï¼š

| è§¦å‘æ–¹å¼ | ç”Ÿæˆçš„æ ‡ç­¾ | ç¤ºä¾‹ |
|---------|-----------|------|
| æ¨é€åˆ° main åˆ†æ”¯ | `main`, `latest` | `username/image:latest` |
| æ¨é€æ ‡ç­¾ v1.2.3 | `v1.2.3`, `1.2`, `latest` | `username/image:v1.2.3` |
| æ¨é€ PR | `pr-123` | `username/image:pr-123` |

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

### æ„å»ºå¤±è´¥

1. æ£€æŸ¥ Actions é¡µé¢çš„é”™è¯¯æ—¥å¿—
2. ç¡®è®¤ Secrets é…ç½®æ­£ç¡®
3. ç¡®è®¤ Docker Hub ç”¨æˆ·åå’Œå¯†ç æœ‰æ•ˆ

### æ¨é€å¤±è´¥

1. æ£€æŸ¥ Docker Hub è´¦å·æ˜¯å¦æœ‰æ¨é€æƒé™
2. å¦‚æœä½¿ç”¨è®¿é—®ä»¤ç‰Œï¼Œç¡®è®¤ä»¤ç‰Œæƒé™åŒ…å« "Read & Write"

### é•œåƒæœªæ›´æ–°

1. ç¡®è®¤å·¥ä½œæµå·²æˆåŠŸè¿è¡Œï¼ˆç»¿è‰²å¯¹å‹¾ï¼‰
2. ç­‰å¾…å‡ åˆ†é’Ÿï¼ŒDocker Hub åŒæ­¥éœ€è¦æ—¶é—´
3. ä½¿ç”¨ `docker pull` æ—¶æ·»åŠ  `--no-cache` å‚æ•°

## ğŸ’¡ é«˜çº§é…ç½®

### è‡ªå®šä¹‰é•œåƒåç§°

ç¼–è¾‘ `.github/workflows/docker-publish.yml`ï¼š
```yaml
env:
  IMAGE_NAME: ä½ çš„é•œåƒåç§°  # ä¿®æ”¹è¿™é‡Œ
```

### åªåœ¨æ ‡ç­¾æ¨é€æ—¶æ„å»º

ä¿®æ”¹è§¦å‘æ¡ä»¶ï¼š
```yaml
on:
  push:
    tags:
      - 'v*'
```

### ä½¿ç”¨ GitHub Container Registry (ghcr.io)

å¦‚æœä¸æƒ³ä½¿ç”¨ Docker Hubï¼Œå¯ä»¥ä½¿ç”¨ GitHub è‡ªå¸¦çš„å®¹å™¨æ³¨å†Œè¡¨ï¼Œæ— éœ€é…ç½®é¢å¤–çš„ Secretsã€‚

---

å®Œæˆé…ç½®åï¼Œä½ çš„ Docker é•œåƒå°†è‡ªåŠ¨æ„å»ºå’Œå‘å¸ƒï¼ğŸ‰
